Ссылка на Event Storming схему https://miro.com/app/board/uXjVItFw6Cc=/?moveToWidget=3458764631092957390&cot=14

Общая логика создания и построения событий заключалась в том, чтобы сделать сервис найма максимально независимым от
других двух сервисов:
- сервис найма должен быть максимально стабильным - его падение приведет в остановки всей системы. падение же других 
сервисов можно и не заметить на какое-то время + после их восстановления можно нагнать упущенное
- в сервисе найма заключена основная функциональность системы, поэтому остальные 2 системы являются дополняющими 
из-за этого в основном события в системе ИСХОДЯЩИЕ из сервиса найма и к этим событиям уже подвязываются остальные 
сервисы

**КОММУНИКАЦИИ**

| Номер<br>связи | Как связь сделана на <br>текущий момент | Какая теперь<br>будет связь                           | Проблемы бизнеса<br>которые <br>потенциално<br>решатся                            | Почему <br>связь необходимо <br>изменить                                                                                                                                                                                                                                                                    |
| -------------- | --------------------------------------- | ----------------------------------------------------- | --------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [COMM- 010]    | HTTP-вызов                              | останется такой же                                    |                                                                                   | Подразумеваю что получение инфы о менеджере вызывается не часто и по необходимости, у бизнеса нет потребности часто менять инфу о менеджере, поэтому сервис найма может просто хранить у себя или кэшировать эту инфу. Не вижу тут смысла усложнять                                                         |
| [COMM- 020]    | HTTP-вызов                              | Асинхронное событие о назначении нового задания       | [Problem-080]                                                                     | Сервис найма в новом способе не зависит от работоспособности сервиса заданий. + назначенные задания можно выгребать батчами если использовать кафку - поможет с ростом нагрузки                                                                                                                             |
| [COMM- 030]    | HTTP-вызов                              | Асинхронное событие о том что задание пора переделать | [Problem-020]<br>[Problem-050]<br>[Problem-070]                                   | Уберет нагрузку с сервиса найма (не нужно руками вызывать метод). Сервис найма станет более независим от работы сервиса заданий                                                                                                                                                                             |
| [COMM- 040]    | HTTP-вызов                              | Асинхронное событие "Задача решена" + рейтинг задания | [Problem-030]<br>[Problem-080]<br>[Problem-040]<br>[Problem-050]<br>[Problem-070] | Нужно доставлять рейтинг вместе с сообщением о решении задачи чтобы рейтинг был актуален на момент решения для правильного начисления бонусов.<br><br>Асинхронные задачи например через кафку можно выгребать батчами что поможет сукорить начисление бонусов (Для [COMM- 050], [COMM- 080] тоже актуально) |
| [COMM- 050]    | HTTP-вызов                              | Асинхронное событие "Задача не решена"                | [Problem-080]<br>[Problem-040]<br>[Problem-050]<br>[Problem-070]                  | Отвяжет сервис найма от сервиса бонусов:<br>- падение сервиса бонусов не скажется на работе сервиса найма<br>- знания о начислениях не будут течь в сервис найма (Так же эти аргументы актуальны для связи [COMM- 040])                                                                                     |
| [COMM- 060]    | Асинхронное событие                     | Эту связь нужно убрать                                | [Problem-030]                                                                     | Рейтинг может доставиться позже чем событие/вызов зачисления бонусов. Поэтому бонусы за часть заданий будут учтены неверно                                                                                                                                                                                  |
| [COMM- 070]    | HTTP-вызов                              | Останется такой же                                    |                                                                                   | Подразумеваю что получение инфы о менеджере вызывается не часто и по необходимости, у бизнеса нет потребности часто менять инфу о менеджере, поэтому сервис бонусов может просто хранить у себя или кэшировать эту инфу. Не вижу тут смысла усложнять                                                       |
| [COMM- 080]    | HTTP-вызов                              | Асинхронное событие "Создана новая задача"            | [Problem-080]                                                                     | Отвязывает сервис заданий от сервиса выплат, падение сервиса выплат не сможет парализовать работу сервиса задач. Делает систему более надежной                                                                                                                                                              |
| [COMM- 090]    | HTTP-вызов                              | Асинхронное событие "Новый учитель в системе"         | [Problem-080]                                                                     | В целом думаю тут можно было бы и HTTP вызов оставить. Но тогда падение сервиса заданий сможет в этом месте повлиять на работу сервиса найма, а такой запрос бизнеса есть, поэтому можно поменять                                                                                                           |


Потенциально все измененные коммуникации должны помочь с проблемой [Problem-090], потому что теперь логика одного сервисов (например логика бонусов) не размазана по остальным а сосредоточена в самом сервисе.

Вероятно улучшения пофиксят [Problem-010]. В изначальной версии после проверки задания надо синхронно вызвать пересчет рейтинга и синхронно вызвать методы сервиса зачисления бонусов - это поход по сети, долго. В новой версии это все превратится в создание асинхронных событий что может быть быстрее.